<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.numberone.system.mapper.TransactionMapper">


    <select id="getTransaction" resultType="java.util.Map">
        select
            transaction_id,
            from_user_id,
            (Select user_name from sys_user where from_user_id = user_id) fromUserName,
            from_wallet_address,
            to_user_id,
            (Select user_name from sys_user where to_user_id = user_id) toUserName,
            to_wallet_address,
            create_time,
            remark,
            from_amount,
            from_wallet_type,
            to_amount,
            to_wallet_type,
            transaction_type,
            fee_amount,
            case transaction_status when '-1' then '交易失败'
                                    when '0' then '交易中'
                                    when '1' then '交易成功'
                end transactionStatus,
            transaction_hash
        from mdc_transaction
        where 0 = 0
        <if test='transactionType!=null and transactionType!=""'>
            and transaction_type=#{transactionType}
        </if>
        <if test='walletAddress!=null and walletAddress!=""'>
            and (from_wallet_address=#{walletAddress} or to_wallet_address=#{walletAddress})
        </if>
    </select>

</mapper>
